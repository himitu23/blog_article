冒頭の画像
/*image*/

# SecHack365　@2017のまとめをアーキテクチャとともに振り返る！ 【Title】

こんにちは。
遅くなりましたが、昨年2017年度に参加していたSecHack365ですが、先月無事に卒業することができました。今回はそのまとめについて書いていきたいと思います。

突然ですが、私達のグループが最終報告回で発表した資料（一部修正）はこちらになります。
/*slideshare*/

改めまして、私は現在電気通信大学の大学院生をやっていますtokina(ひみつ)です。昔はネットワーク系の研究室に所属しており、自動車のセキュリティについての研究をしていました。現在は電通大のネットワーク系の研究室に移籍し、IoTに関する研究をしております。昨年からパブリッククラウド技術に興味を持ち始め、今回SecHack365の私のチームの中でもクラウド部分をメインに担当しています。

まず、SecHack365について詳しくは以下のページをご参照下さい。
https://sechack365.nict.go.jp

また、日程が非常に近いですが、SECCON×SecHackのセチャコンというイベントが開催予定です。皆さんよければ足を運んでみて下さい。秋葉原行きましょう！

https://2017.seccon.jp/news/sechackcon2018.html

現在('18.04.09執筆時)には2019年度生を募集しています。課題申し込みと提出申し込み締切が異なるので注意して下さい。
https://sechack365.nict.go.jp/requirements/

実は以前、セキュリティ・キャンプ中国において簡単なLTの場をいただき、そこで作成した簡単な資料については既に公開しております。
http://tokina.hatenadiary.jp/entry/2017/11/01/155847

今回、一年の総轄として、この記事にまとめました。SecHack365参加を目指す方の参考になれば幸いです。

##　私にとってのSecHack365（SecHack367）とは

私にとって、振り返ってみるとSecHack365とは技術的交流はもちろん、自身のモチベーションをしてくれる環境でした。

しかし、この機会で出会うことが出来た人や、今後の指針が見えてきたこともあり、私にとってはとても大切な一年だったことは間違いないと思っています。

ちなみに就職活動とかでも役に立つと思います！

え、SecHack367とはなんですか？気になる方は参加して見ましょう！

## 応募のキッカケ

キッカケとは些細なものだと思います。私はセキュリティ・キャンプに参加していたので、サイボウズで情報が流れてきており、耳にはしていました。しかし、私はギリギリまで申し込んではいなかったのです。

申し込み期限前日、私はそういえばと思いサイボウズを開き、このSecHack365に応募しました。ちなみに応募課題は非公開だそうです。

最初、SecHack365を見たときに、「キャンプ関連なんだろうか・・・」くらいに漠然と考えていました。

実際に参加するとキャンプの講師やTAレベルの人が沢山おり、最初は不安でいっぱいでした。。。

ちなみに選考の基準ですが、「参加してともにイノベーションを起こせるか（なにか新しいことをひらめけるか）」だそうです（たしかそういっていた）。

学歴や大学、住んでいる場所とかは一切選考に関係ないそうです。また、名前も伏せて選考されます。つまり、応募者が何を考えているかの本質が見られるのだと思います。

プログラミング能力は必須でしょうか？

私は”必須”だと思います。無いと困るとかではなく、少なくとも「アイデアを実現する力」のタネが必要だと思います。まぁハッカソンだからとも言えるでしょうか。

ちなみに私のプログラミング能力はそんなに高くない...と思っています。

## チームメイトの紹介

私のチームは４人チームでした。チームメイトは私を含め以下の方たちでした。

@o_hi_rangosta, @kiyoooo44,@_tokina23 (私), @Balius1064

また、途中で（私が勝手にお願いして）特別顧問として協力してくれた

@Shi_ma715, @sm_nz_gk

みなさん、ありがとうございました！

## SecHack365でなにをつくっていたのか？

私のグループでハッカソンしていたのは、一言で言うと **『自動車の情報を収集し、自動車情報を利活用するプラットフォーム』** です。最初の着眼点は「パブリッククラウドを使って自動車の情報を収集した例って聞いたこと無いよね？」「簡単にできそうだけど、実際に作ってみたらなにか見えてこないかな？」というところからでした。そこから見えてきたのが **「自動運転のための運転者データの収集」** でした。

全体の概要図は下図のようになります。こちらは実際の成果発表会で使用した資料を一部修正したものです。
/*image*/

実際にこのハッカソンでは **自動車に搭載する車載器から、フロントエンドの可視化まで一貫して作成** しています。これにより、自動車を完全に”IoT”化することに成功したのです。

最終的にハッカソンで出来上がったアーキテクチャですが、もともとこのような最終形を想定していませんでした。今回は折角なので、そのアーキテクチャとともに振り返ってみたいと思います。

### アーキテクチャと若干詳しい解説

私達グループメンバーはこの概要図にある通り、全体のうちの一部をそれぞれを担当していました。私はこの中でAWSやその周辺を主に担当しています。最初に掲載した資料にもありますが、最終的なアーキテクチャは下図のようになりました。

/*image*/

データの流れに注目しましょう。まず、自動車に搭載された車載器からSORACOMへとデータが転送されます。ちなみにこの時データはSORACOMの専用回線を利用してアップロードされます。

そののち、SORACOM Funnelというサービスを利用して、AWS Kinesis Streamへとデータをストリーム転送します。このFunnelとはアップロードのみに特化したサービスです。一度AWS Kinesis Streamに流れてきたデータは少しポーリングされるため、厳密にはリアルタイムではありません。

次にKinesis StreamのデータがポーリングされるとAWS Lambdaのメインとなるプログラムがキックされ、Base64でデコード、JSONを取り出します。その後、異常値検出（ここでは簡単に閾値を決め打ちしています）、ElasticsearchにPOST、AWS SNSのキック、S3にデータをPOSTします。

管理者向けの利用を想定した可視化として、AWSに用意されているElasticsearc ServiceのKibanaを利用しています。ここで可視化されるデータとその型は以下です。

- 位置情報(GPS)
    - geo_point
- 速度
    - double
- エンジン回転数(RPM, rotation per minutes)
    - int
- ステアリング
    - double
- CANの使用帯域(bandwidth)
    - double
- 自動車情報(自動車ID)
    - Text
- エラーメッセージ
    - Text

AWS SNSは通知サービスです。SNSで一括管理する通知先をLambdaで指定することで、複数の宛先（Slack, e-mail, LINEなど）へ一度に通知します。ここで、SlackやLINE(+IFTTT)はweb hookを噛ませないといけないので、スケーラビリティのため別のLambdaで実行しています。

S3に保存したデータは自動車情報毎に分けられ、全て生のテキストファイルとして置かれており、運転評価を行うEC2サーバ（今回はFlaskを利用してwebアプリを構築している）からデータを取得しに行きます。

EC2サーバで行う運転評価については/*twitterid*/が作成してくれました。

また、同じように/*twitterid*/さんが作成してくれたUnityアプリケーションはS3へデータを取りに行くのですが、AWS SDKを利用してデータにアクセスするための認証にCognitoとIAMを利用して承認を行っています。

以上が全体のデータの流れになります。

## 振り返り

SecHack365は（昨年度は）全部で7回のオフラインハッカソンと、その間のオンラインハッカソンで行われます。昨年度の日程は以下でした。

- 2017 04 東京 NICT(国立) 顔合わせ
- 2017 05 東京 蒲田 アイデアソン
- 2017 08 福岡 LINE福岡/志賀島 縁日（ワークショップ）、ハッカソン
- 2017 10 北海道 札幌 縁日（ワークショップ）、ハッカソン
- 2017 12 大阪 ハッカソン
- 2018 02 沖縄 糸満 成果報告
- 2018 03 東京 秋葉原 最終成果報告、ポスター展示

最初は運営の方々も手探り状態で、私達が最初の卒業生になるということもあり、一期生としての”責任”のようなものを感じていました。私達のグループメンバーは、蒲田回のアイデアソンのときから一貫して変わりませんでしたが、多くのひとはソロプレイヤーになったりするなど、悩んでいる人も多かったかな、という印象です。

### 2017 08 福岡 LINE福岡/志賀島 縁日（ワークショップ）、ハッカソン
### 2017 10 北海道 札幌 縁日（ワークショップ）、ハッカソン
### 2017 12 大阪 ハッカソン
### 2018 02 沖縄 糸満 成果報告
### 2018 03 東京 秋葉原 最終成果報告、ポスター展示

## 最後に

最後に展示させて頂いたポスターの資料はこちらになります。

/*slidesahre*/


## 書きたいこと
- 以前の投稿についての振り返り
- SecHack365について、再び説明
- 自分が志望した動機について
- チームメイトの紹介
- 流れの全体像について
- 実際の振り返り
    - 各回の振り返りを写真と自分たちのフロー
    - 同時にシステムアーキテクチャ
- 最後に
