# IoTSecJP #5 memo

slido.com

```
IoTSecJP東京 Version5.0

時刻	タイトル	時間	その他
12:30	開場	30[min]	IoTSecJP運営
13:00	会場書注意など	5[min]	IoTSecJP運営( @r00tapple )
13:05	「{登壇内容調整中}」	30[min]	kidasan ( @kidasan)
13:35	「{登壇内容調整中}」	30[min]	NV ( @nvsofts)
14:05	「Hardware Trojan できるかな」	30[min]	omoikane ( @jm6xxu)
14:35	休憩	10[min]	
14:45	「ドローン コレクション 2019年 春」	15[min]	hogehuga ( @hogehuga)
14:50	「IoT Securityコンサルトしてハードウェア設計/実機診断をやったときのリアルな事例を紹介してみますよ」	30[min]	kawashin1 ( @kawashin1)
15:20	[LTEデバイス攻略までの3ステップ]	30[min]	RyskUmts(@tansokun920)
15:50	[安全性の高いプログラミング言語でのIoTデバイス開発について]	30[min]	LDScell(@LDScell)
16:20	[Wi-Fiのチャネルベース中間者攻撃とKRACKsの話]	30[min]	Nao(@nsec_life)
16:50	[電力線通信に対するDoS攻撃の検討]	30[min]	Hidekazu Asaba(@Belboz16)
17:20	「4Kカメラをハッキングしてインスタ映えしてみた」	30[min]	黒林檎 ( @r00tapple )
17:50頃	終わりに	5[min]	IoTSecJP運営 ( @r00tapple )
18:00	撤収		参加各位
```



## 1. Kidasan

CANのリアルタイム性をいじしつつ不正ECUを特定できるやつをSCIS2018で発表

最近の流れ，勉強会開催などについて

＊相関電力解析に期待するもの

​	サイドチャネル攻撃と呼ぶと範囲が広すぎる，これをもっと狭く呼びたい

​	いまはマルチコアになっている→非同期になっているので相関電力解析では読むのは非常に難しい

​	この仕組を利用してCANバス上におけるTCU経由で汚染された不正ECUを検知できるのでは？

＊実際に試してみる

仮定：プロセスが動いおているのだから何らかの波形が見れるはず

実際に観測しても解析は難しい

目立つのはWiFiのScanくらい？プログラムの解析までは非常に困難

4コアで動いているので，どのプログラムがどこで走っているのかも難しい

相関電力解析してハッキングしても現状では難しい

＊解析してわかること

スケジューリングする際には電力が低下する（振幅が下がる？）

＊やろうとしていること

波形の一つ一つをタスクに紐付け，何が見えるか検証してみる

デバイスの電源にAddするだけのエンドポイントセキュリティ

？

オシロスコープの周波数1GHz

カーネルの先のプロセスが非常に難しい

## 2. Omoikaneさん

スライドが非常に参考になる

サイバーディフェンス研究所

Hardware Trojanしたい

結論：できませんでした（できたら会社のブログに書きます）

時間がなかった？？年度末進行は難しい

Hardware Troja

Bloomberg Businessweek

小さいマイクロチップが中国にデータを送っている？

ファーウェイ排除？分解したら余計なものが見つかった？

今回は文献調査

THe Hardware Trojan War

https://www.amazon.co.jp/Hardware-Trojan-War-Attacks-Defenses-ebook/dp/B078C83MMV

> ハードウェアトロイとは特定の目的を達成するために回路の動作を変更するように設計された，回路の意図的かつ悪意のある改変

- NSA Toolkit

- SOLDERPEEK
- SLOTSCREAMER
  - コンバータを利用してメモリを改変
- Bad USBーWiFi搭載版

初期から入っているタイプ

**PCB**

​	受動素子に擬態

​	非常に小さいCPU，電源をつなぐとプロセッサとして動作する

​	サイズはに2ミリ

Arduino Uno

＊論理回路の改変

SiCレベル

＊アナログ回路の改変

同じキーでも電力の出力が違う→攻撃者が後から解析することも可能

＊初期段階からはいいっているタイプの特徴

PoCレベルはたくさんある

しかし，実際に存在しているかは現状不明

​	入っていても正常な動作を実現しないといけないので，わざわざハードウェアとして実現する意味は．．．

​	ソフトウェアで実現したほうがいい？

最初から入っているバックドアの検知は非常に難しい

サプライヤーレベルでセキュリティの観点を入れるといいのでは？

→実際に信頼できるサプライヤーのリストとかはない？

​	→ないらしい

## 3. NVさん

eMMCの話

組込み用のメモリ

最高400MB/sの転送速度

パーティション：ブート１，ブート２，ユーザデータ，RPMB

​	ユーザーデータは普段ユーザーがデータを格納するところ

＊eMMC pin

Vcc電源，VccQ，

Vss, VssW: GND,

CLK

CMD command io

＊eMMCの吸出しツール

ROMライターRT809H

JTAG Box: Easy JTAG

一部のSDカードリーダ

​	TranscendのTS-RDF5Kが使える（ユーザデータ領域しか読めない

E-MATE Xがいい感じに読める：１３種類に対応している

Youtubeにいい感じに動画があるよ

EXEなど解析ソフトはVMで実行したほうがいい（怪しいので）

## 4. hogehugaさん

最近のドローンの話

水中ドローン

酒気帯び運転＠ドローン

ドローンの事故率，故障率（少なくとも公開されていない？）

DJIのTelloがおすすめ，JSONでやりとりしているらしい？

## 5. F-secure

河野　真一郎

Cloud Security ＆ IoT Security

営業職らしい

今回は情報収集と勉強できた人向けのLT

Fセキュアのコンサルの話？６００人くらいはコンサルティング業務に従事

ヨーロッパでCyber Crimeがあった場合に調査コンサルティング業務を行っているのがメインの会社（具体的に何件なのか不明，事実老舗の会社）

１４年以上のIoTコンサルティング業務経験

F-Secure 車載IoT機器　セキュリティ診断サービス

​	車載IoT以外にも，機内IoT，航空管制システムなど

＊カーナビの攻撃テスト

システムファームウェア抜出し，入れ替え可能か

CANBUS用のData Diode，他のシステムが，，

CAN BUSの分離が完璧か，ファームウェアアップデートの仕組みに脆弱性はないか，侵入できるかペネトレしてみる→さらにそれらに基づいて対策事例をアウトプットする？？？？

具体的な攻撃手法は？それは結局口外できない部分は多い

https://andrea.io

にてFセキュアが発見した資料などを公開しているらしいので，是非活用ください？

Q&Aがほしい！

２０１７年にロゴが赤くなりました

車関係ー日本とヨーロッパで意識の違いは何がある？ヨーロッパでは全体のテストのお願いがあった，日本ではやらなければいけないので探していますと最近着てる気がします（問い合わせ），アメリカもやっている（何社か言っちゃダメらしいい，５−６年，テスラは？）

ウェアラブルデバイスについてのペネトレもあったらしい

日本にもペネトレの人がいる？クラウドと飛行機を攻撃できる人がいるとかフィンランド人が強い（人が来る）

認証機器の診断対応は？

動画ー実際に可能でしょ？というFセキュアのデモ

​	実際にFセキュアにこうしたセキュリティ業務を依頼してみた？

ライバル意識をもつより，一緒に良くしていきましょう

## 6. Uematuさん

うえまつ　りょうすけさん

LTE通信するデバイスを診断する際の３ステップ

１．LTEプロトコルのセキュリティ

2017年からセキュリティ業務へ従事

SDRをつかって偽装基地局をつかったセキュリティ診断

デバイスをハックして中から！

＊LTEプロトコルのセキュリティ評価

- SIMについて
  - K値（128bit）
  - IMSI　SIMを識別する番号
  - MSISDN　電話番号など

LTEFuzzとなつけられたツールを用いて検証→認証バイパスできる脆弱性が発見されたらしい

アタッチ，？，ハンドオーバ

アタッチの認証シーケンスをバイパスできる脆弱性があった場合には？

​	これはLoRaWANのアクティベーションでも同様のことが言える

中身がわかっているSIMカードがないと偽装できない

IoTデバイスで使用されるSIMは組み込みSIM（eSIM）（つまり差し替えなどが考慮されていない）

eSIMとSIMの違いは形状のみ

実機で試したところ，実際にeSIMでむりやり普通のSIMに差し替えてみたら仏に出来た（これでテストSIMを指して脆弱性診断もできそう）

＊実際に診断してみよう



携帯電話はなぜつながるのか？

LTEの教科書

標準ドキュメント・・・

OpenAir Interfaceというものもあるらしい

LTE　Securiityの論文

OpenLTEとSRS LTEは？SRS LTEのほうが手が入れやすい（通信事業単位のノード単位でソースコードが書かれているらしい）

https://www.softwareradiosystems.com/tag/srslte/

https://www.openairinterface.org

https://github.com/srsLTE/srsLTE

## 7. LDScellさん

セキュアなプログラミングするためには？　Rustか？

メモリ安全である？バッファオーバーフロー/バッファオーバーラン，Nullポインタ参照．．．

HeartBleed攻撃　Point：メモリ操作の実装バグ（バッファオーバーラン）

情報漏えい＜サービス停止（プロセスクラッシュ）

コンパイルエラーになる（これが一番理想）

組み込みではC/C++でするしかないのでは？

IoTデバイス開発でもプログラミング言語に制限がなくなりつつある

LLVMーGCCに匹敵するコンパイラ実装の敷居がさがった

LLVMで解釈できる中間言語を出力できる言語でればいい→自作できる

Go，Rustも現在対応している

Tiny Go

Rustは簡単にかける言語ではない（難しい）

メモリ管理をコンパイラがかなり検証

その他方安全やメモリ検証などまでサポート

コンパイラが厳しい！

Rustではめちゃくちゃに厳しいコンパイルレベルがあるうらしい

言語仕様特徴

- 所有権
- 借用
- ライフタイム

RustではHeart Bleedは発生しなかったのではないのか？

所有権の例：アドレスを参照して他の変数から他の変数の値を変更することが出来ない

​	所有権は一つのみ，コンパイルエラー

​	これは動的配列でも同様

Rustの組み込みの本

​	Emmbedded Rust Book (和訳済み)

https://tomoyuki-nakabayashi.github.io/book/

​	Discovery （和訳中）

IPv6 TCPエコーサーバ

​	C言語上のRTOS（Zephyr）上で動くアプリケーションをRustで実装

​	C言語で既存で動く部分の上でRustで開発できれば

C言語とのギャップが大きく，学習コストが高い

C/C++の試算が大きい，これから増やしていく必要があり

新しい言語

connectFree社開発（2015~）

ZEN

Reduce your stress

## 8. Naoさん

CSAを利用したチャネルベース中間者攻撃の論文発表

- 日本でも同攻撃の実現可能性

ラックでセキュリティエンジニアしています

実際に攻撃してみた / channel-based MitM Attacks

資料がほしい

krachattacks-poc-zerokey

KRACKs demo tool

KRACKの脆弱性があればWPA2の復号ができる

今までのIpアドレスが変わっている→ニセのAPにつながっている？

先と同様にネットにはつながる，しかし中間者攻撃が成功している

WPA2の通信が復号されている→KRACKの脆弱性

再接続要求をビーコンを出して行わせる

＊対策は？

通信が暗号化された状態のみチャネル情報を交換する

クライアント側でCSAを無効化

2.4GHz帯でも5GHzでも関係ない（クライアントが対応しているうと結局同様）

低レイヤパケット解析は楽しい！

チャネル変更する必要がある？

＊

日本での中間者攻撃の実現は微妙に難しい

## 9. 火災受信機

電力線通信に対するDoS攻撃

消防法

＊やってみた

火災検知ビットをなりすましてみる

先月四国電力で再現性の解説がされている（愛媛新聞）

## 10. 黒林檎さん

プリンタからドメインコントローラへペンテスト

https://iot-security.wiki/

https://codeby.net/

Orange PiとLime SDRで基地局を偽装するデモ

解析してバックドアを開いてみる→自分で操作できますよね

ただ，そこら編ハックしても保証してませんよ

脆弱性の開示→IPAへ報告

バックドア消えました

＊分析フェーズ

１．ハードウェア分析

２．ファームウェア分析

３．無線プロトコル分析

４．モバイルアプリケーション

５．webアプリケーション

６．クラウドサービス

推測による指摘や公開は控える

まずは届け出ることが先

！脆弱性を見つけたら届け出ることが大事